// Generated by CoffeeScript 1.8.0
var CryptoTools, crypto;

crypto = require("crypto");

module.exports = CryptoTools = (function() {
  function CryptoTools() {
    this.masterKey = null;
    this.slaveKey = null;
  }

  CryptoTools.prototype.genHash = function(data) {
    return crypto.createHash('sha256').update(data).digest('binary');
  };

  CryptoTools.prototype.applySalt = function(data, salt) {
    return data + salt;
  };

  CryptoTools.prototype.genHashWithSalt = function(data, salt) {
    var newData;
    newData = data + salt;
    return crypto.createHash('sha256').update(newData).digest('binary');
  };

  CryptoTools.prototype.genSalt = function(length) {
    var string;
    string = "";
    while (string.length < length) {
      string += Math.random().toString(36).substr(2);
    }
    return string.substr(0, length);
  };

  CryptoTools.prototype.encrypt = function(key, data) {
    var cipher, crypted;
    cipher = crypto.createCipher('aes-256-cbc', key.toString());
    crypted = cipher.update(data.toString(), 'binary', 'base64');
    crypted += cipher.final('base64');
    return crypted;
  };

  CryptoTools.prototype.decrypt = function(key, data) {
    var decipher, decrypted;
    decipher = crypto.createDecipher('aes-256-cbc', key.toString());
    decrypted = decipher.update(data.toString(), 'base64', 'utf8');
    decrypted += decipher.final('utf8');
    return decrypted;
  };

  return CryptoTools;

})();
